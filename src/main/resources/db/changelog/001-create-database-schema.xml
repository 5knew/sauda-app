<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.20.xsd">

    <changeSet id="001-create-suppliers-table" author="sauda-dev">
        <createTable tableName="suppliers">
            <column name="id" type="BIGSERIAL" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="tenant_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="contact_person" type="VARCHAR(255)"/>
            <column name="phone" type="VARCHAR(50)"/>
            <column name="email" type="VARCHAR(255)"/>
            <column name="address" type="TEXT"/>
            <column name="is_active" type="BOOLEAN" defaultValueBoolean="true"/>
        </createTable>
        <addUniqueConstraint tableName="suppliers" columnNames="tenant_id, name"/>
    </changeSet>

    <changeSet id="002-create-shops-table" author="sauda-dev">
        <createTable tableName="shops">
            <column name="id" type="BIGSERIAL" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="tenant_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="owner_id" type="BIGINT"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP"/>
        </createTable>
        <addUniqueConstraint tableName="shops" columnNames="tenant_id"/>
    </changeSet>

    <changeSet id="003-create-product-categories-table" author="sauda-dev">
        <createTable tableName="product_categories">
            <column name="id" type="BIGSERIAL" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="tenant_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="parent_id" type="BIGINT"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="product_categories" baseColumnNames="parent_id"
                                 referencedTableName="product_categories" referencedColumnNames="id"
                                 constraintName="fk_product_categories_parent" onDelete="SET NULL"/>
        <addUniqueConstraint tableName="product_categories" columnNames="tenant_id, name"/>
    </changeSet>

    <changeSet id="004-create-units-table" author="sauda-dev">
        <createTable tableName="units">
            <column name="id" type="BIGSERIAL" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="tenant_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="symbol" type="VARCHAR(50)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addUniqueConstraint tableName="units" columnNames="tenant_id, name"/>
    </changeSet>

    <changeSet id="005-create-products-table" author="sauda-dev">
        <createTable tableName="products">
            <column name="id" type="BIGSERIAL" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="tenant_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="barcode" type="VARCHAR(50)">
                <constraints nullable="false"/>
            </column>
            <column name="sku" type="VARCHAR(50)">
                <constraints nullable="false"/>
            </column>
            <column name="category_id" type="BIGINT"/>
            <column name="unit_id" type="BIGINT"/>
            <column name="description" type="TEXT"/>
            <column name="is_active" type="BOOLEAN" defaultValueBoolean="true"/>
            <column name="is_deleted" type="BOOLEAN" defaultValueBoolean="false"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="products" baseColumnNames="category_id"
                                 referencedTableName="product_categories" referencedColumnNames="id"
                                 constraintName="fk_products_category" onDelete="SET NULL"/>
        <addForeignKeyConstraint baseTableName="products" baseColumnNames="unit_id"
                                 referencedTableName="units" referencedColumnNames="id"
                                 constraintName="fk_products_unit" onDelete="SET NULL"/>
        <addUniqueConstraint tableName="products" columnNames="tenant_id, sku"/>
        <addUniqueConstraint tableName="products" columnNames="barcode"/>
    </changeSet>

    <changeSet id="006-create-product-attributes-table" author="sauda-dev">
        <createTable tableName="product_attributes">
            <column name="id" type="BIGSERIAL" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="tenant_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="data_type" type="VARCHAR(50)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="007-create-product-attribute-values-table" author="sauda-dev">
        <createTable tableName="product_attribute_values">
            <column name="id" type="BIGSERIAL" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="product_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="attribute_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="value_string" type="TEXT"/>
            <column name="value_number" type="NUMERIC"/>
            <column name="value_boolean" type="BOOLEAN"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="product_attribute_values" baseColumnNames="product_id"
                                 referencedTableName="products" referencedColumnNames="id"
                                 constraintName="fk_product_attribute_values_product" onDelete="CASCADE"/>
        <addForeignKeyConstraint baseTableName="product_attribute_values" baseColumnNames="attribute_id"
                                 referencedTableName="product_attributes" referencedColumnNames="id"
                                 constraintName="fk_product_attribute_values_attribute" onDelete="CASCADE"/>
    </changeSet>

    <changeSet id="008-create-employees-table" author="sauda-dev">
        <createTable tableName="employees">
            <column name="id" type="BIGSERIAL" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="tenant_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="full_name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="position" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="hired_date" type="DATE">
                <constraints nullable="false"/>
            </column>
            <column name="is_active" type="BOOLEAN" defaultValueBoolean="true"/>
        </createTable>
        <addUniqueConstraint tableName="employees" columnNames="tenant_id, full_name"/>
    </changeSet>

    <changeSet id="009-create-roles-table" author="sauda-dev">
        <createTable tableName="roles">
            <column name="id" type="BIGSERIAL" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="tenant_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="VARCHAR(50)">
                <constraints nullable="false"/>
            </column>
            <column name="permissions_json" type="JSONB"/>
        </createTable>
        <addUniqueConstraint tableName="roles" columnNames="tenant_id, name"/>
    </changeSet>

    <changeSet id="010-create-users-table" author="sauda-dev">
        <createTable tableName="users">
            <column name="id" type="BIGSERIAL" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="tenant_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="username" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="password_hash" type="TEXT">
                <constraints nullable="false"/>
            </column>
            <column name="employee_id" type="BIGINT"/>
            <column name="role_id" type="BIGINT"/>
            <column name="shop_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint baseTableName="users" baseColumnNames="employee_id"
                                 referencedTableName="employees" referencedColumnNames="id"
                                 constraintName="fk_users_employee" onDelete="SET NULL"/>
        <addForeignKeyConstraint baseTableName="users" baseColumnNames="role_id"
                                 referencedTableName="roles" referencedColumnNames="id"
                                 constraintName="fk_users_role" onDelete="SET NULL"/>
        <addForeignKeyConstraint baseTableName="users" baseColumnNames="shop_id"
                                 referencedTableName="shops" referencedColumnNames="id"
                                 constraintName="fk_users_shop" onDelete="CASCADE"/>
        <addUniqueConstraint tableName="users" columnNames="tenant_id, username"/>
    </changeSet>

    <changeSet id="011-add-shops-owner-foreign-key" author="sauda-dev">
        <addForeignKeyConstraint baseTableName="shops" baseColumnNames="owner_id"
                                 referencedTableName="users" referencedColumnNames="id"
                                 constraintName="fk_shops_owner" onDelete="SET NULL"/>
    </changeSet>

    <changeSet id="012-create-user-shop-roles-table" author="sauda-dev">
        <createTable tableName="user_shop_roles">
            <column name="id" type="BIGSERIAL" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="user_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="shop_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="role_id" type="BIGINT"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="user_shop_roles" baseColumnNames="user_id"
                                 referencedTableName="users" referencedColumnNames="id"
                                 constraintName="fk_user_shop_roles_user" onDelete="CASCADE"/>
        <addForeignKeyConstraint baseTableName="user_shop_roles" baseColumnNames="shop_id"
                                 referencedTableName="shops" referencedColumnNames="id"
                                 constraintName="fk_user_shop_roles_shop" onDelete="CASCADE"/>
        <addForeignKeyConstraint baseTableName="user_shop_roles" baseColumnNames="role_id"
                                 referencedTableName="roles" referencedColumnNames="id"
                                 constraintName="fk_user_shop_roles_role" onDelete="SET NULL"/>
        <addUniqueConstraint tableName="user_shop_roles" columnNames="user_id, shop_id"/>
    </changeSet>

    <changeSet id="013-create-warehouses-table" author="sauda-dev">
        <createTable tableName="warehouses">
            <column name="id" type="BIGSERIAL" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="tenant_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="location" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>

    <changeSet id="014-create-inventory-table" author="sauda-dev">
        <createTable tableName="inventory">
            <column name="id" type="BIGSERIAL" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="tenant_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="product_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="warehouse_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="quantity" type="NUMERIC" defaultValueNumeric="0"/>
            <column name="last_updated" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="inventory" baseColumnNames="product_id"
                                 referencedTableName="products" referencedColumnNames="id"
                                 constraintName="fk_inventory_product" onDelete="CASCADE"/>
        <addForeignKeyConstraint baseTableName="inventory" baseColumnNames="warehouse_id"
                                 referencedTableName="warehouses" referencedColumnNames="id"
                                 constraintName="fk_inventory_warehouse" onDelete="CASCADE"/>
        <addUniqueConstraint tableName="inventory" columnNames="tenant_id, product_id, warehouse_id"/>
    </changeSet>

    <changeSet id="015-create-purchase-orders-table" author="sauda-dev">
        <createTable tableName="purchase_orders">
            <column name="id" type="BIGSERIAL" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="tenant_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="supplier_id" type="BIGINT"/>
            <column name="warehouse_id" type="BIGINT"/>
            <column name="order_date" type="DATE">
                <constraints nullable="false"/>
            </column>
            <column name="total_amount" type="NUMERIC">
                <constraints nullable="false"/>
            </column>
            <column name="status" type="VARCHAR(50)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint baseTableName="purchase_orders" baseColumnNames="supplier_id"
                                 referencedTableName="suppliers" referencedColumnNames="id"
                                 constraintName="fk_purchase_orders_supplier" onDelete="SET NULL"/>
        <addForeignKeyConstraint baseTableName="purchase_orders" baseColumnNames="warehouse_id"
                                 referencedTableName="warehouses" referencedColumnNames="id"
                                 constraintName="fk_purchase_orders_warehouse" onDelete="SET NULL"/>
    </changeSet>

    <changeSet id="016-create-purchase-order-items-table" author="sauda-dev">
        <createTable tableName="purchase_order_items">
            <column name="id" type="BIGSERIAL" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="tenant_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="purchase_order_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="product_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="quantity" type="NUMERIC">
                <constraints nullable="false"/>
            </column>
            <column name="price" type="NUMERIC">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint baseTableName="purchase_order_items" baseColumnNames="purchase_order_id"
                                 referencedTableName="purchase_orders" referencedColumnNames="id"
                                 constraintName="fk_purchase_order_items_order" onDelete="CASCADE"/>
        <addForeignKeyConstraint baseTableName="purchase_order_items" baseColumnNames="product_id"
                                 referencedTableName="products" referencedColumnNames="id"
                                 constraintName="fk_purchase_order_items_product" onDelete="CASCADE"/>
    </changeSet>

    <changeSet id="017-create-pos-terminals-table" author="sauda-dev">
        <createTable tableName="pos_terminals">
            <column name="id" type="BIGSERIAL" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="tenant_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="location" type="VARCHAR(255)"/>
            <column name="is_online" type="BOOLEAN" defaultValueBoolean="true"/>
        </createTable>
        <addUniqueConstraint tableName="pos_terminals" columnNames="tenant_id, name"/>
    </changeSet>

    <changeSet id="018-create-customers-table" author="sauda-dev">
        <createTable tableName="customers">
            <column name="id" type="BIGSERIAL" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="tenant_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="full_name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="phone" type="VARCHAR(50)"/>
            <column name="email" type="VARCHAR(255)"/>
            <column name="discount_card" type="VARCHAR(50)"/>
        </createTable>
        <addUniqueConstraint tableName="customers" columnNames="tenant_id, discount_card"/>
    </changeSet>

    <changeSet id="019-create-sales-table" author="sauda-dev">
        <createTable tableName="sales">
            <column name="id" type="BIGSERIAL" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="tenant_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="sale_date" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP"/>
            <column name="employee_id" type="BIGINT"/>
            <column name="customer_id" type="BIGINT"/>
            <column name="pos_terminal_id" type="BIGINT"/>
            <column name="total_amount" type="NUMERIC">
                <constraints nullable="false"/>
            </column>
            <column name="payment_method" type="VARCHAR(50)"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="sales" baseColumnNames="employee_id"
                                 referencedTableName="employees" referencedColumnNames="id"
                                 constraintName="fk_sales_employee" onDelete="SET NULL"/>
        <addForeignKeyConstraint baseTableName="sales" baseColumnNames="customer_id"
                                 referencedTableName="customers" referencedColumnNames="id"
                                 constraintName="fk_sales_customer" onDelete="SET NULL"/>
        <addForeignKeyConstraint baseTableName="sales" baseColumnNames="pos_terminal_id"
                                 referencedTableName="pos_terminals" referencedColumnNames="id"
                                 constraintName="fk_sales_pos_terminal" onDelete="SET NULL"/>
    </changeSet>

    <changeSet id="020-create-sales-items-table" author="sauda-dev">
        <createTable tableName="sales_items">
            <column name="id" type="BIGSERIAL" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="tenant_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="sale_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="product_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="quantity" type="NUMERIC">
                <constraints nullable="false"/>
            </column>
            <column name="price" type="NUMERIC">
                <constraints nullable="false"/>
            </column>
            <column name="discount" type="NUMERIC"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="sales_items" baseColumnNames="sale_id"
                                 referencedTableName="sales" referencedColumnNames="id"
                                 constraintName="fk_sales_items_sale" onDelete="CASCADE"/>
        <addForeignKeyConstraint baseTableName="sales_items" baseColumnNames="product_id"
                                 referencedTableName="products" referencedColumnNames="id"
                                 constraintName="fk_sales_items_product" onDelete="CASCADE"/>
        <addUniqueConstraint tableName="sales_items" columnNames="tenant_id, sale_id, product_id"/>
    </changeSet>

    <changeSet id="021-create-payments-table" author="sauda-dev">
        <createTable tableName="payments">
            <column name="id" type="BIGSERIAL" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="tenant_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="sale_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="amount" type="NUMERIC">
                <constraints nullable="false"/>
            </column>
            <column name="payment_type" type="VARCHAR(50)"/>
            <column name="payment_date" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="payments" baseColumnNames="sale_id"
                                 referencedTableName="sales" referencedColumnNames="id"
                                 constraintName="fk_payments_sale" onDelete="CASCADE"/>
    </changeSet>

    <changeSet id="022-create-price-list-table" author="sauda-dev">
        <createTable tableName="price_list">
            <column name="id" type="BIGSERIAL" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="tenant_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="product_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="price" type="NUMERIC">
                <constraints nullable="false"/>
            </column>
            <column name="start_date" type="DATE">
                <constraints nullable="false"/>
            </column>
            <column name="end_date" type="DATE"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="price_list" baseColumnNames="product_id"
                                 referencedTableName="products" referencedColumnNames="id"
                                 constraintName="fk_price_list_product" onDelete="CASCADE"/>
        <addUniqueConstraint tableName="price_list" columnNames="tenant_id, product_id, start_date"/>
    </changeSet>

    <changeSet id="023-create-discount-rules-table" author="sauda-dev">
        <createTable tableName="discount_rules">
            <column name="id" type="BIGSERIAL" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="tenant_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="description" type="TEXT"/>
            <column name="discount_type" type="VARCHAR(50)">
                <constraints nullable="false"/>
            </column>
            <column name="value" type="NUMERIC">
                <constraints nullable="false"/>
            </column>
            <column name="start_date" type="DATE">
                <constraints nullable="false"/>
            </column>
            <column name="end_date" type="DATE"/>
            <column name="applies_to" type="VARCHAR(50)"/>
        </createTable>
    </changeSet>

    <changeSet id="024-create-audit-log-table" author="sauda-dev">
        <createTable tableName="audit_log">
            <column name="id" type="BIGSERIAL" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="tenant_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="user_id" type="BIGINT"/>
            <column name="action" type="TEXT">
                <constraints nullable="false"/>
            </column>
            <column name="object_type" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="object_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="timestamp" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP"/>
            <column name="details_json" type="JSONB"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="audit_log" baseColumnNames="user_id"
                                 referencedTableName="users" referencedColumnNames="id"
                                 constraintName="fk_audit_log_user" onDelete="CASCADE"/>
    </changeSet>

    <changeSet id="025-create-product-history-table" author="sauda-dev">
        <createTable tableName="product_history">
            <column name="id" type="BIGSERIAL" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="tenant_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="product_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="changed_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP"/>
            <column name="old_value" type="JSONB"/>
            <column name="new_value" type="JSONB"/>
            <column name="changed_by" type="BIGINT"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="product_history" baseColumnNames="product_id"
                                 referencedTableName="products" referencedColumnNames="id"
                                 constraintName="fk_product_history_product" onDelete="CASCADE"/>
        <addForeignKeyConstraint baseTableName="product_history" baseColumnNames="changed_by"
                                 referencedTableName="users" referencedColumnNames="id"
                                 constraintName="fk_product_history_user" onDelete="SET NULL"/>
    </changeSet>

    <changeSet id="026-create-error-log-table" author="sauda-dev">
        <createTable tableName="error_log">
            <column name="id" type="BIGSERIAL" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="tenant_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="error_message" type="TEXT">
                <constraints nullable="false"/>
            </column>
            <column name="error_type" type="VARCHAR(50)">
                <constraints nullable="false"/>
            </column>
            <column name="occurred_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP"/>
        </createTable>
    </changeSet>

    <changeSet id="027-create-indexes" author="sauda-dev">
        <createIndex tableName="products" indexName="idx_products_tenant_id">
            <column name="tenant_id"/>
        </createIndex>
        <createIndex tableName="products" indexName="idx_products_barcode">
            <column name="barcode"/>
        </createIndex>
        <createIndex tableName="products" indexName="idx_products_sku">
            <column name="sku"/>
        </createIndex>
        <createIndex tableName="products" indexName="idx_products_category_id">
            <column name="category_id"/>
        </createIndex>
        <createIndex tableName="products" indexName="idx_products_is_active">
            <column name="is_active"/>
        </createIndex>

        <createIndex tableName="sales" indexName="idx_sales_tenant_id">
            <column name="tenant_id"/>
        </createIndex>
        <createIndex tableName="sales" indexName="idx_sales_sale_date">
            <column name="sale_date"/>
        </createIndex>
        <createIndex tableName="sales" indexName="idx_sales_employee_id">
            <column name="employee_id"/>
        </createIndex>
        <createIndex tableName="sales" indexName="idx_sales_customer_id">
            <column name="customer_id"/>
        </createIndex>

        <createIndex tableName="inventory" indexName="idx_inventory_tenant_id">
            <column name="tenant_id"/>
        </createIndex>
        <createIndex tableName="inventory" indexName="idx_inventory_product_id">
            <column name="product_id"/>
        </createIndex>
        <createIndex tableName="inventory" indexName="idx_inventory_warehouse_id">
            <column name="warehouse_id"/>
        </createIndex>

        <createIndex tableName="audit_log" indexName="idx_audit_log_tenant_id">
            <column name="tenant_id"/>
        </createIndex>
        <createIndex tableName="audit_log" indexName="idx_audit_log_user_id">
            <column name="user_id"/>
        </createIndex>
        <createIndex tableName="audit_log" indexName="idx_audit_log_timestamp">
            <column name="timestamp"/>
        </createIndex>

        <createIndex tableName="product_history" indexName="idx_product_history_tenant_id">
            <column name="tenant_id"/>
        </createIndex>
        <createIndex tableName="product_history" indexName="idx_product_history_product_id">
            <column name="product_id"/>
        </createIndex>
        <createIndex tableName="product_history" indexName="idx_product_history_changed_at">
            <column name="changed_at"/>
        </createIndex>
    </changeSet>

</databaseChangeLog>

